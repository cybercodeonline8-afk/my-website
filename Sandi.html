<!doctype html>

<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Generator Kata Sandi Kuat ‚Äî Bikin Kata Sandi Acak</title>
  <style>
    :root{
      --bg:#0f1724; /* dark */
      --card:#0b1220;
      --accent:#7c3aed;
      --muted:#94a3b8;
      --glass: rgba(255,255,255,0.03);
      --success:#10b981;
    }
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,Roboto,Segoe UI,Arial; background: linear-gradient(180deg,#071021 0%, #07112a 100%); color:#e6eef8; margin:0; padding:32px; display:flex; align-items:center; justify-content:center; min-height:100vh}
    .card{width:100%; max-width:760px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:14px; padding:26px; box-shadow: 0 8px 30px rgba(2,6,23,0.6); border:1px solid rgba(255,255,255,0.04)}
    h1{margin:0 0 6px 0; font-size:20px}
    p.lead{margin:0 0 18px 0; color:var(--muted); font-size:13px}.output{display:flex; gap:8px; align-items:center}
.password-box{flex:1; background:var(--glass); padding:14px 12px; border-radius:10px; font-family:monospace; font-size:16px; color:#e6eef8; overflow-x:auto}
button.btn{background:var(--accent); border:none; color:white; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600}
button.ghost{background:transparent; border:1px solid rgba(255,255,255,0.06)}

.controls{display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-top:16px}
.card-block{background:rgba(255,255,255,0.02); padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.02)}
label{display:block; font-size:13px; margin-bottom:6px}

.row{display:flex; gap:8px; align-items:center}
input[type=range]{width:100%}
.small{font-size:13px; color:var(--muted)}

.options{display:flex; flex-direction:column; gap:8px}
.option{display:flex; gap:10px; align-items:center}
.option input{width:18px;height:18px}

.meter{height:10px; border-radius:8px; background:rgba(255,255,255,0.03); overflow:hidden}
.meter > i{display:block; height:100%; width:0%;}
.meter-text{font-weight:700; font-size:13px}

.hint{font-size:13px; color:var(--muted); margin-top:12px}
footer{margin-top:14px; font-size:12px; color:var(--muted)}

@media (max-width:640px){.controls{grid-template-columns:1fr} .card{padding:18px}}

  </style>
</head>
<body>
  <div class="card" role="region" aria-label="Generator Kata Sandi">
    <h1>Generator Kata Sandi Kuat üîê</h1>
    <p class="lead">Bikin kata sandi acak dan kuat. Pilih panjang dan karakter yang mau dimasukin ‚Äî lalu salin. Gampang banget!</p><div class="output">
  <div id="password" class="password-box" aria-live="polite">Klik "Generate" untuk buat kata sandi</div>
  <div style="display:flex;flex-direction:column;gap:8px">
    <button id="generateBtn" class="btn">Generate</button>
    <button id="copyBtn" class="ghost">Salin</button>
  </div>
</div>

<div class="controls">
  <div class="card-block">
    <label for="length">Panjang: <span id="lenVal">16</span></label>
    <div class="row"><input id="length" type="range" min="6" max="64" value="16"></div>

    <div style="margin-top:12px" class="options">
      <label class="small">Jenis karakter</label>
      <label class="option"><input id="lower" type="checkbox" checked> Huruf kecil (a-z)</label>
      <label class="option"><input id="upper" type="checkbox" checked> Huruf besar (A-Z)</label>
      <label class="option"><input id="numbers" type="checkbox" checked> Angka (0-9)</label>
      <label class="option"><input id="symbols" type="checkbox" checked> Simbol (!@#...)</label>
      <label class="option"><input id="noAmbig" type="checkbox"> Hindari karakter ambigu (l,1,I,O,0)</label>
    </div>
  </div>

  <div class="card-block">
    <label class="small">Kekuatan kata sandi</label>
    <div style="display:flex;gap:10px;align-items:center">
      <div class="meter" style="flex:1"><i id="meterBar"></i></div>
      <div class="meter-text" id="meterText">‚Äî</div>
    </div>

    <div style="margin-top:14px">
      <label class="small">Opsi lanjutan</label>
      <div class="option"><input id="pronounceable" type="checkbox"> Buat mudah diingat (kurangi simbol acak)</div>
      <div class="option"><input id="avoidRepeat" type="checkbox" checked> Hindari pengulangan berurutan</div>
    </div>

    <div class="hint">Tip: gunakan kata sandi panjang & unik untuk tiap akun. Simpan di password manager.</div>
  </div>
</div>

<footer>Butuh fitur lain? Misal ekspor CSV, preset, atau generator frasa kata? Bilang aja üòâ</footer>

  </div>  <script>
    // Karakter set
    const sets = {
      lower: 'abcdefghijklmnopqrstuvwxyz',
      upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
      numbers: '0123456789',
      symbols: '!@#$%^&*()_+[]{}|;:,.<>?/~`-='
    };

    // Ambiguous chars
    const ambiguous = new Set(['l','I','1','O','0','o']);

    // Elemen
    const lengthEl = document.getElementById('length');
    const lenVal = document.getElementById('lenVal');
    const passwordEl = document.getElementById('password');
    const generateBtn = document.getElementById('generateBtn');
    const copyBtn = document.getElementById('copyBtn');
    const meterBar = document.getElementById('meterBar');
    const meterText = document.getElementById('meterText');

    // opsi
    const lower = document.getElementById('lower');
    const upper = document.getElementById('upper');
    const numbers = document.getElementById('numbers');
    const symbols = document.getElementById('symbols');
    const noAmbig = document.getElementById('noAmbig');
    const pronounceable = document.getElementById('pronounceable');
    const avoidRepeat = document.getElementById('avoidRepeat');

    // update tampilan
    lengthEl.addEventListener('input', ()=>{ lenVal.textContent = lengthEl.value; updateMeter(); });
    [lower,upper,numbers,symbols,noAmbig,pronounceable,avoidRepeat].forEach(el=> el.addEventListener('change', updateMeter));

    function secureRandomInt(max){
      // gunakan crypto.getRandomValues jika tersedia
      if(window.crypto && crypto.getRandomValues){
        const arr = new Uint32Array(1);
        crypto.getRandomValues(arr);
        return arr[0] % max;
      }else{
        return Math.floor(Math.random()*max);
      }
    }

    function pickRandom(str){
      return str.charAt(secureRandomInt(str.length));
    }

    function generatePassword(){
      const len = parseInt(lengthEl.value,10);
      let pool = '';
      if(lower.checked) pool += sets.lower;
      if(upper.checked) pool += sets.upper;
      if(numbers.checked) pool += sets.numbers;
      if(symbols.checked) pool += sets.symbols;

      if(!pool) return 'Pilih minimal 1 jenis karakter!';

      // remove ambiguous
      if(noAmbig.checked){
        pool = Array.from(pool).filter(ch => !ambiguous.has(ch)).join('');
      }

      // Pronounceable (simple approach): alternating consonant+vowel groups
      if(pronounceable.checked){
        const vowels = 'aeiouyAEIOUY';
        const consonants = Array.from(pool).filter(c => !vowels.includes(c)).join('');
        let pw = '';
        for(let i=0;i<len;i++){
          if(i%2===0){ // consonant-ish
            if(consonants.length) pw += pickRandom(consonants);
            else pw += pickRandom(pool);
          }else{
            const v = Array.from(pool).filter(c=>vowels.includes(c)).join('');
            if(v.length) pw += pickRandom(v);
            else pw += pickRandom(pool);
          }
        }
        if(avoidRepeat.checked) pw = removeRepeats(pw);
        return pw;
      }

      // Normal random
      let result = '';
      // Ensure at least one char from each selected class for better strength
      const classes = [];
      if(lower.checked) classes.push(sets.lower);
      if(upper.checked) classes.push(sets.upper);
      if(numbers.checked) classes.push(sets.numbers);
      if(symbols.checked) classes.push(sets.symbols);

      // apply noAmbig to classes too
      if(noAmbig.checked){
        for(let i=0;i<classes.length;i++){
          classes[i] = Array.from(classes[i]).filter(ch => !ambiguous.has(ch)).join('');
        }
      }

      // put at least one from each selected class
      for(const cls of classes){
        if(cls.length>0){ result += pickRandom(cls); }
      }

      while(result.length < len){
        result += pickRandom(pool);
      }

      // shuffle
      result = shuffleString(result).slice(0,len);

      if(avoidRepeat.checked) result = removeRepeats(result);

      return result;
    }

    function shuffleString(str){
      const arr = Array.from(str);
      for(let i=arr.length-1;i>0;i--){
        const j = secureRandomInt(i+1);
        [arr[i],arr[j]] = [arr[j],arr[i]];
      }
      return arr.join('');
    }

    function removeRepeats(s){
      // replace runs of 3+ identical characters
      return s.replace(/(.)\1{2,}/g, (m, ch)=> ch+ch);
    }

    function estimateEntropy(pw){
      // rough entropy estimate: log2(poolSize^len) = len*log2(poolSize)
      let poolSize = 0;
      if(lower.checked) poolSize += (noAmbig.checked ? sets.lower.split('').filter(c=>!ambiguous.has(c)).length : sets.lower.length);
      if(upper.checked) poolSize += (noAmbig.checked ? sets.upper.split('').filter(c=>!ambiguous.has(c)).length : sets.upper.length);
      if(numbers.checked) poolSize += (noAmbig.checked ? sets.numbers.split('').filter(c=>!ambiguous.has(c)).length : sets.numbers.length);
      if(symbols.checked) poolSize += (noAmbig.checked ? sets.symbols.split('').filter(c=>!ambiguous.has(c)).length : sets.symbols.length);
      if(poolSize<=0) return 0;
      const len = parseInt(lengthEl.value,10);
      const entropy = len * Math.log2(poolSize);
      return entropy;
    }

    function updateMeter(){
      const entropy = estimateEntropy();
      // map entropy to 0-100
      const val = Math.max(0, Math.min(100, Math.round((entropy/80)*100)));
      meterBar.style.width = val + '%';
      // color
      let color = '#ef4444'; // red
      let text = 'Lemah';
      if(entropy>60){ color = 'linear-gradient(90deg,#16a34a,#60a5fa)'; text='Sangat Kuat'; }
      else if(entropy>45){ color = 'linear-gradient(90deg,#059669,#10b981)'; text='Kuat'; }
      else if(entropy>30){ color = 'linear-gradient(90deg,#f59e0b,#ef4444)'; text='Cukup'; }
      else { color = 'linear-gradient(90deg,#ef4444,#f97316)'; text='Lemah'; }
      // set background using simple approach: use rgba overlay (can't set gradient on <i> easily cross-browser), so use multiple stops via transform
      meterBar.style.background = 'linear-gradient(90deg, rgba(124,58,237,1), rgba(96,165,250,0.9))';
      meterText.textContent = text + ' ('+Math.round(entropy)+' bit)';
    }

    generateBtn.addEventListener('click', ()=>{
      const pw = generatePassword();
      passwordEl.textContent = pw;
      updateMeter();
    });

    copyBtn.addEventListener('click', async ()=>{
      const text = passwordEl.textContent || '';
      if(!text || text.startsWith('Pilih')) return alert('Belum ada kata sandi untuk disalin!');
      try{
        await navigator.clipboard.writeText(text);
        copyBtn.textContent = 'Tersalin! ‚úÖ';
        setTimeout(()=> copyBtn.textContent = 'Salin', 1500);
      }catch(e){
        // fallback
        const ta = document.createElement('textarea'); ta.value = text; document.body.appendChild(ta); ta.select(); try{ document.execCommand('copy'); copyBtn.textContent='Tersalin! ‚úÖ'; setTimeout(()=> copyBtn.textContent = 'Salin',1500);}catch(err){ alert('Tidak bisa menyalin otomatis ‚Äî silakan salin manual.'); } ta.remove();
      }
    });

    // init
    lenVal.textContent = lengthEl.value;
    updateMeter();
  </script></body>
</html>